#!/bin/bash

if [ -e 'build/.devel' ]
	then

	versionfile='src/version.h';

	major=$(grep -P 'MAJOR' $versionfile | sed -E 's/[^0-9]+//');
	minor=$(grep -P 'MINOR' $versionfile | sed -E 's/[^0-9]+//');
	build=$(grep -P 'BUILD' $versionfile | sed -E 's/[^0-9]+//');

	let 'build+=1';
	
	echo '#ifndef VERSION_H' >  $versionfile;
	echo '#define VERSION_H' >> $versionfile;
	echo '//warning: this file is automatically generated, do not modify' >> $versionfile;
	echo "#define VERSION_MAJOR $major" >> $versionfile;
	echo "#define VERSION_MINOR $minor" >> $versionfile;
	echo "#define VERSION_BUILD $build" >> $versionfile;
	echo '#endif' >> $versionfile;

fi
